{% extends "base.html" %} {% block content %}

<!-- BANNER -->
<section
  class="section-hero overlay inner-page bg-image"
  id="home-section"
  style="background-image: url({{ url_for('static', filename='img/susan-yin-2JIvboGLeho-unsplash.jpg')}})"
>
  <div class="container">
    <div class="row">
      <div class="col-md-7">
        <h1 class="text-white font-weight-bold">Edit Post</h1>
        <div class="custom-breadcrumbs">
          <a href="{{url_for('index')}}">Home</a>
          <span class="mx-2 slash">/</span>
          <a href="{{url_for('account.account_post')}}">Post</a>
          <span class="mx-2 slash">/</span>
          <span class="text-white"><strong>Edit Post</strong></span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- CREATE POST FORM -->
<section class="site-section">
  <div class="container">
    <div class="row align-items-center mb-5">
      <div class="col-lg-8 mb-4 mb-lg-0">
        <div class="d-flex align-items-center">
          <div>
            <h2>Edit Post</h2>
          </div>
        </div>
      </div>
    </div>
    <form
      method="POST"
      action="{{url_for('account.edit_post')}}"
      enctype="multipart/form-data"
    >
      <div class="row mb-5">
        <div class="col-lg-12">
          <div class="form-group">
            <label for="post-title">Title</label>
            <input
              type="text"
              class="form-control"
              id="post-title"
              name="post-title"
              value="{{data.title|safe}}"
              placeholder="Education Material Title"
            />
          </div>
          <div class="form-group">
            <label for="post-description">Description</label>
            <textarea
              class="form-control"
              id="post-description"
              name="post-description"
              rows="5"
              maxlength="255"
            >
{{data.description|safe}}</textarea
            >
            <div
              id="error-note"
              class="alert alert-danger mt-4"
              role="alert"
            ></div>

            {% if error %}
            <div class="alert alert-danger mt-4" role="alert">{{ error }}</div>
            {% endif %} {% if info %}
            <div class="alert alert-success mt-4" role="alert">{{ info }}</div>
            {% endif %}
          </div>
        </div>
      </div>
      <div class="row align-items-center mb-5">
        <div class="col-lg-4 ml-auto">
          <div class="row">
            <div class="text-right offset-6 col-6">
              <input
                type="hidden"
                name="post-id"
                id="post-id"
                value="{{ data.post_id }}"
              />
              <input
                type="hidden"
                name="csrf_token"
                id="csrf_token"
                value="{{ csrf_token() }}"
              />
              <input
                type="submit"
                id="submit"
                value="Change"
                class="btn px-4 btn-primary text-white"
              />
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>
</section>

<script>
  $(document).ready(function () {
    $("#error-note").hide();
    $("form").validate({
      errorLabelContainer: "#error-note",
      errorElement: "div",
      rules: {
        "post-title": {
          required: true,
        },
        "post-description": {
          maxLength: 255,
        },
      },
      messages: {
        "post-title": "Please enter the education material title.",
      },
      invalidHandler: function (event, validator) {
        // 'this' refers to the form
        var errors = validator.numberOfInvalids();
        if (errors) {
          $("#error-note").show();
        } else {
          $("#error-note").text = "";
          $("#error-note").hide();
        }
      },
      submitHandler: function (form) {
        $("#error-note").text = "";
        $("#error-note").hide();
        $(form).ajaxSubmit();
      },
    });
  });
</script>

{% endblock %}
